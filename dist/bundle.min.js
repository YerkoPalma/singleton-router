(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.RouterSingleton=f()}})(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _interopDefault(ex){return ex&&typeof ex==="object"&&"default"in ex?ex["default"]:ex}var UrlPattern=_interopDefault(require("url-pattern"));var assert=_interopDefault(require("assert"));var RouterSingleton=function(){function RouterSingleton(){_classCallCheck(this,RouterSingleton)}_createClass(RouterSingleton,null,[{key:"getRouter",value:function getRouter(options){if(typeof window.RouterInstance_!=="undefined"){return window.RouterInstance_}window.RouterInstance_=new Router(options);return window.RouterInstance_}}]);return RouterSingleton}();var Router=function(){function Router(options){var _this=this;_classCallCheck(this,Router);this.routes={};this.currentPath=null;this.previousPath=null;this.currentRoute=null;this.previousRoute=null;this.root=null;this.firstRender=true;this.rootEl=null;this.store=null;this.default=null;this._debug=false;this.onRender=options&&options.onRender?options.onRender:null;this.onNavClick=options&&options.onNavClick?options.onNavClick:null;this.prefix=options&&options.prefix?options.prefix:"";window.addEventListener("popstate",function(e){_this.onPopState(e)});var links=document.querySelectorAll("[data-route]");Array.prototype.forEach.call(links,function(link){link.addEventListener("click",function(event){event.preventDefault();link.setAttribute("data-bind",+new Date);_this.goToPath(link.getAttribute("data-route"));if(typeof _this.onNavClick==="function")_this.onNavClick(link.getAttribute("data-route"),link)})})}_createClass(Router,[{key:"setStore",value:function setStore(store){this.store=store}},{key:"addRoute",value:function addRoute(pattern,view,cb){assert.equal(typeof pattern,"string");assert.equal(typeof view,"function");assert(typeof cb==="undefined"||typeof cb==="function");this.routes[pattern]=new Route(pattern,view,cb)}},{key:"setRoot",value:function setRoot(path){path=path||"/";this.root=this.getRoute(path);if(!this.root){this.addRoute("/",function(){return document.createElement("div")});this.root=this.routes["/"]}}},{key:"start",value:function start(selector){assert(typeof selector==="undefined"||typeof selector==="string");assert(Object.keys(this.routes).length>0);assert.notEqual(this.root,null);this.rootEl=document.querySelector(selector)||document.body;this.requestStateUpdate()}},{key:"onPopState",value:function onPopState(e){if(e)e.preventDefault();this.requestStateUpdate(e)}},{key:"getRoute",value:function getRoute(path){assert.equal(typeof path,"string");var posibleRoutes=[];for(var pattern in this.routes){if(this.routes.hasOwnProperty(pattern)){if(this.routes[pattern]._urlPattern.match(path)!==null)posibleRoutes.push(this.routes[pattern])}}if(posibleRoutes.length===1)return posibleRoutes[0];if(posibleRoutes.length===0)return null}},{key:"notFound",value:function notFound(notFoundView){assert.equal(typeof notFoundView,"function");this.default=new Route(null,notFoundView)}},{key:"goToPath",value:function goToPath(path,title){var _this2=this;title=title||null;if(path===window.location.pathname){return}this.previousPath=window.location.pathname;this.currentPath=path;this.previousRoute=this.currentRoute||this.root;this.currentRoute=this.getRoute(this.currentPath);window.history.pushState(undefined,title,path);window.requestAnimationFrame(function(){_this2.manageState()})}},{key:"manageState",value:function manageState(){var self=this;if(this.currentPath===this.previousPath)return;if(!this.currentRoute&&this.default)this.currentRoute=this.default;var currentView=this.currentRoute.onStart(this.store);if(this.firstRender&&currentView){this.firstRender=false;this.rootEl.appendChild(currentView)}else if(!this.onRender||typeof this.onRender!=="function"){var child=this.rootEl.lasttElementChild||this.rootEl.lastChild;this.rootEl.replaceChild(currentView,child)}else{var _child=this.rootEl.lasttElementChild||this.rootEl.lastChild;this.onRender(currentView,_child,this.currentRoute.cb)}var links=document.querySelectorAll("a[data-route]");Array.prototype.forEach.call(links,function(link){link.addEventListener("click",function(e){e.preventDefault();if(!link.getAttribute("data-bind"))self.goToPath(link.getAttribute("data-route"));if(typeof self.onNavClick==="function")self.onNavClick(link.getAttribute("data-route"),link)})});if((!this.onRender||typeof this.onRender!=="function")&&typeof this.currentRoute.cb==="function"){try{this.currentRoute.cb()}catch(ex){console.error(ex)}}}},{key:"requestStateUpdate",value:function requestStateUpdate(e){var _this3=this;this.previousPath=this.currentPath;this.currentPath=window.location.pathname;this.currentRoute=this.getRoute(e&&e.target!==window?e.target.getAttribute("data-route"):window.location.pathname);window.requestAnimationFrame(function(){_this3.manageState()})}}]);return Router}();var Route=function(){function Route(pattern,view,cb){_classCallCheck(this,Route);this.pattern=pattern;this.cb=cb;this._urlPattern=pattern?new UrlPattern(pattern):null;this.view=view;this.params=null;this.path=null}_createClass(Route,[{key:"getParams",value:function getParams(){if(!this.path)return false;return this.params}},{key:"setParams",value:function setParams(){if(!this.path)return false;this.params=this._urlPattern?this._urlPattern.match(this.path):null}},{key:"onStart",value:function onStart(store){this.path=window.location.pathname;this.params=this._urlPattern?this._urlPattern.match(this.path):null;return this.view(this.params,store)}}]);return Route}();var index_js=RouterSingleton.getRouter;module.exports=index_js},{assert:2,"url-pattern":4}],2:[function(require,module,exports){(function(global){"use strict";function compare(a,b){if(a===b){return 0}var x=a.length;var y=b.length;for(var i=0,len=Math.min(x,y);i<len;++i){if(a[i]!==b[i]){x=a[i];y=b[i];break}}if(x<y){return-1}if(y<x){return 1}return 0}function isBuffer(b){if(global.Buffer&&typeof global.Buffer.isBuffer==="function"){return global.Buffer.isBuffer(b)}return!!(b!=null&&b._isBuffer)}var util=require("util/");var hasOwn=Object.prototype.hasOwnProperty;var pSlice=Array.prototype.slice;var functionsHaveNames=function(){return function foo(){}.name==="foo"}();function pToString(obj){return Object.prototype.toString.call(obj)}function isView(arrbuf){if(isBuffer(arrbuf)){return false}if(typeof global.ArrayBuffer!=="function"){return false}if(typeof ArrayBuffer.isView==="function"){return ArrayBuffer.isView(arrbuf)}if(!arrbuf){return false}if(arrbuf instanceof DataView){return true}if(arrbuf.buffer&&arrbuf.buffer instanceof ArrayBuffer){return true}return false}var assert=module.exports=ok;var regex=/\s*function\s+([^\(\s]*)\s*/;function getName(func){if(!util.isFunction(func)){return}if(functionsHaveNames){return func.name}var str=func.toString();var match=str.match(regex);return match&&match[1]}assert.AssertionError=function AssertionError(options){this.name="AssertionError";this.actual=options.actual;this.expected=options.expected;this.operator=options.operator;if(options.message){this.message=options.message;this.generatedMessage=false}else{this.message=getMessage(this);this.generatedMessage=true}var stackStartFunction=options.stackStartFunction||fail;if(Error.captureStackTrace){Error.captureStackTrace(this,stackStartFunction)}else{var err=new Error;if(err.stack){var out=err.stack;var fn_name=getName(stackStartFunction);var idx=out.indexOf("\n"+fn_name);if(idx>=0){var next_line=out.indexOf("\n",idx+1);out=out.substring(next_line+1)}this.stack=out}}};util.inherits(assert.AssertionError,Error);function truncate(s,n){if(typeof s==="string"){return s.length<n?s:s.slice(0,n)}else{return s}}function inspect(something){if(functionsHaveNames||!util.isFunction(something)){return util.inspect(something)}var rawname=getName(something);var name=rawname?": "+rawname:"";return"[Function"+name+"]"}function getMessage(self){return truncate(inspect(self.actual),128)+" "+self.operator+" "+truncate(inspect(self.expected),128)}function fail(actual,expected,message,operator,stackStartFunction){throw new assert.AssertionError({message:message,actual:actual,expected:expected,operator:operator,stackStartFunction:stackStartFunction})}assert.fail=fail;function ok(value,message){if(!value)fail(value,true,message,"==",assert.ok)}assert.ok=ok;assert.equal=function equal(actual,expected,message){if(actual!=expected)fail(actual,expected,message,"==",assert.equal)};assert.notEqual=function notEqual(actual,expected,message){if(actual==expected){fail(actual,expected,message,"!=",assert.notEqual)}};assert.deepEqual=function deepEqual(actual,expected,message){if(!_deepEqual(actual,expected,false)){fail(actual,expected,message,"deepEqual",assert.deepEqual)}};assert.deepStrictEqual=function deepStrictEqual(actual,expected,message){if(!_deepEqual(actual,expected,true)){fail(actual,expected,message,"deepStrictEqual",assert.deepStrictEqual)}};function _deepEqual(actual,expected,strict,memos){if(actual===expected){return true}else if(isBuffer(actual)&&isBuffer(expected)){return compare(actual,expected)===0}else if(util.isDate(actual)&&util.isDate(expected)){return actual.getTime()===expected.getTime()}else if(util.isRegExp(actual)&&util.isRegExp(expected)){return actual.source===expected.source&&actual.global===expected.global&&actual.multiline===expected.multiline&&actual.lastIndex===expected.lastIndex&&actual.ignoreCase===expected.ignoreCase}else if((actual===null||typeof actual!=="object")&&(expected===null||typeof expected!=="object")){return strict?actual===expected:actual==expected}else if(isView(actual)&&isView(expected)&&pToString(actual)===pToString(expected)&&!(actual instanceof Float32Array||actual instanceof Float64Array)){return compare(new Uint8Array(actual.buffer),new Uint8Array(expected.buffer))===0}else if(isBuffer(actual)!==isBuffer(expected)){return false}else{memos=memos||{actual:[],expected:[]};var actualIndex=memos.actual.indexOf(actual);if(actualIndex!==-1){if(actualIndex===memos.expected.indexOf(expected)){return true}}memos.actual.push(actual);memos.expected.push(expected);return objEquiv(actual,expected,strict,memos)}}function isArguments(object){return Object.prototype.toString.call(object)=="[object Arguments]"}function objEquiv(a,b,strict,actualVisitedObjects){if(a===null||a===undefined||b===null||b===undefined)return false;if(util.isPrimitive(a)||util.isPrimitive(b))return a===b;if(strict&&Object.getPrototypeOf(a)!==Object.getPrototypeOf(b))return false;var aIsArgs=isArguments(a);var bIsArgs=isArguments(b);if(aIsArgs&&!bIsArgs||!aIsArgs&&bIsArgs)return false;if(aIsArgs){a=pSlice.call(a);b=pSlice.call(b);return _deepEqual(a,b,strict)}var ka=objectKeys(a);var kb=objectKeys(b);var key,i;if(ka.length!==kb.length)return false;ka.sort();kb.sort();for(i=ka.length-1;i>=0;i--){if(ka[i]!==kb[i])return false}for(i=ka.length-1;i>=0;i--){key=ka[i];if(!_deepEqual(a[key],b[key],strict,actualVisitedObjects))return false}return true}assert.notDeepEqual=function notDeepEqual(actual,expected,message){if(_deepEqual(actual,expected,false)){fail(actual,expected,message,"notDeepEqual",assert.notDeepEqual)}};assert.notDeepStrictEqual=notDeepStrictEqual;function notDeepStrictEqual(actual,expected,message){if(_deepEqual(actual,expected,true)){fail(actual,expected,message,"notDeepStrictEqual",notDeepStrictEqual)}}assert.strictEqual=function strictEqual(actual,expected,message){if(actual!==expected){fail(actual,expected,message,"===",assert.strictEqual)}};assert.notStrictEqual=function notStrictEqual(actual,expected,message){if(actual===expected){fail(actual,expected,message,"!==",assert.notStrictEqual)}};function expectedException(actual,expected){if(!actual||!expected){return false}if(Object.prototype.toString.call(expected)=="[object RegExp]"){return expected.test(actual)}try{if(actual instanceof expected){return true}}catch(e){}if(Error.isPrototypeOf(expected)){return false}return expected.call({},actual)===true}function _tryBlock(block){var error;try{block()}catch(e){error=e}return error}function _throws(shouldThrow,block,expected,message){var actual;if(typeof block!=="function"){throw new TypeError('"block" argument must be a function')}if(typeof expected==="string"){message=expected;expected=null}actual=_tryBlock(block);message=(expected&&expected.name?" ("+expected.name+").":".")+(message?" "+message:".");if(shouldThrow&&!actual){fail(actual,expected,"Missing expected exception"+message)}var userProvidedMessage=typeof message==="string";var isUnwantedException=!shouldThrow&&util.isError(actual);var isUnexpectedException=!shouldThrow&&actual&&!expected;if(isUnwantedException&&userProvidedMessage&&expectedException(actual,expected)||isUnexpectedException){fail(actual,expected,"Got unwanted exception"+message)}if(shouldThrow&&actual&&expected&&!expectedException(actual,expected)||!shouldThrow&&actual){throw actual}}assert.throws=function(block,error,message){_throws(true,block,error,message)};assert.doesNotThrow=function(block,error,message){_throws(false,block,error,message)};assert.ifError=function(err){if(err)throw err};var objectKeys=Object.keys||function(obj){var keys=[];for(var key in obj){if(hasOwn.call(obj,key))keys.push(key)}return keys}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"util/":7}],3:[function(require,module,exports){var process=module.exports={};var cachedSetTimeout;var cachedClearTimeout;function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}(function(){try{if(typeof setTimeout==="function"){cachedSetTimeout=setTimeout}else{cachedSetTimeout=defaultSetTimout}}catch(e){cachedSetTimeout=defaultSetTimout}try{if(typeof clearTimeout==="function"){cachedClearTimeout=clearTimeout}else{cachedClearTimeout=defaultClearTimeout}}catch(e){cachedClearTimeout=defaultClearTimeout}})();function runTimeout(fun){if(cachedSetTimeout===setTimeout){return setTimeout(fun,0)}if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout){cachedSetTimeout=setTimeout;return setTimeout(fun,0)}try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}function runClearTimeout(marker){if(cachedClearTimeout===clearTimeout){return clearTimeout(marker)}if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout){cachedClearTimeout=clearTimeout;return clearTimeout(marker)}try{return cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}var queue=[];var draining=false;var currentQueue;var queueIndex=-1;function cleanUpNextTick(){if(!draining||!currentQueue){return}draining=false;if(currentQueue.length){queue=currentQueue.concat(queue)}else{queueIndex=-1}if(queue.length){drainQueue()}}function drainQueue(){if(draining){return}var timeout=runTimeout(cleanUpNextTick);draining=true;var len=queue.length;while(len){currentQueue=queue;queue=[];while(++queueIndex<len){if(currentQueue){currentQueue[queueIndex].run()}}queueIndex=-1;len=queue.length}currentQueue=null;draining=false;runClearTimeout(timeout)}process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1){for(var i=1;i<arguments.length;i++){args[i-1]=arguments[i]}}queue.push(new Item(fun,args));if(queue.length===1&&!draining){runTimeout(drainQueue)}};function Item(fun,array){this.fun=fun;this.array=array}Item.prototype.run=function(){this.fun.apply(null,this.array)};process.title="browser";process.browser=true;process.env={};process.argv=[];process.version="";process.versions={};function noop(){}process.on=noop;process.addListener=noop;process.once=noop;process.off=noop;process.removeListener=noop;process.removeAllListeners=noop;process.emit=noop;process.prependListener=noop;process.prependOnceListener=noop;process.listeners=function(name){return[]};process.binding=function(name){throw new Error("process.binding is not supported")};process.cwd=function(){return"/"};process.chdir=function(dir){throw new Error("process.chdir is not supported")};process.umask=function(){return 0}},{}],4:[function(require,module,exports){var slice=[].slice;(function(root,factory){if("function"===typeof define&&define.amd!=null){return define([],factory)}else if(typeof exports!=="undefined"&&exports!==null){return module.exports=factory()}else{return root.UrlPattern=factory()}})(this,function(){var P,UrlPattern,astNodeContainsSegmentsForProvidedParams,astNodeToNames,astNodeToRegexString,baseAstNodeToRegexString,concatMap,defaultOptions,escapeForRegex,getParam,keysAndValuesToObject,newParser,regexGroupCount,stringConcatMap,stringify;escapeForRegex=function(string){return string.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")};concatMap=function(array,f){var i,length,results;results=[];i=-1;length=array.length;while(++i<length){results=results.concat(f(array[i]))}return results};stringConcatMap=function(array,f){var i,length,result;result="";i=-1;length=array.length;while(++i<length){result+=f(array[i])}return result};regexGroupCount=function(regex){return new RegExp(regex.toString()+"|").exec("").length-1};keysAndValuesToObject=function(keys,values){var i,key,length,object,value;object={};i=-1;length=keys.length;while(++i<length){key=keys[i];value=values[i];if(value==null){continue}if(object[key]!=null){if(!Array.isArray(object[key])){object[key]=[object[key]]}object[key].push(value)}else{object[key]=value}}return object};P={};P.Result=function(value,rest){this.value=value;this.rest=rest};P.Tagged=function(tag,value){this.tag=tag;this.value=value};P.tag=function(tag,parser){return function(input){var result,tagged;result=parser(input);if(result==null){return}tagged=new P.Tagged(tag,result.value);return new P.Result(tagged,result.rest)}};P.regex=function(regex){return function(input){var matches,result;matches=regex.exec(input);if(matches==null){return}result=matches[0];return new P.Result(result,input.slice(result.length))}};P.sequence=function(){var parsers;parsers=1<=arguments.length?slice.call(arguments,0):[];return function(input){var i,length,parser,rest,result,values;i=-1;length=parsers.length;values=[];rest=input;while(++i<length){parser=parsers[i];result=parser(rest);if(result==null){return}values.push(result.value);rest=result.rest}return new P.Result(values,rest)}};P.pick=function(){var indexes,parsers;indexes=arguments[0],parsers=2<=arguments.length?slice.call(arguments,1):[];return function(input){var array,result;result=P.sequence.apply(P,parsers)(input);if(result==null){return}array=result.value;result.value=array[indexes];return result}};P.string=function(string){var length;length=string.length;return function(input){if(input.slice(0,length)===string){return new P.Result(string,input.slice(length))}}};P.lazy=function(fn){var cached;cached=null;return function(input){if(cached==null){cached=fn()}return cached(input)}};P.baseMany=function(parser,end,stringResult,atLeastOneResultRequired,input){var endResult,parserResult,rest,results;rest=input;results=stringResult?"":[];while(true){if(end!=null){endResult=end(rest);if(endResult!=null){break}}parserResult=parser(rest);if(parserResult==null){break}if(stringResult){results+=parserResult.value}else{results.push(parserResult.value)}rest=parserResult.rest}if(atLeastOneResultRequired&&results.length===0){return}return new P.Result(results,rest)};P.many1=function(parser){return function(input){return P.baseMany(parser,null,false,true,input)}};P.concatMany1Till=function(parser,end){return function(input){return P.baseMany(parser,end,true,true,input)}};P.firstChoice=function(){var parsers;parsers=1<=arguments.length?slice.call(arguments,0):[];return function(input){var i,length,parser,result;i=-1;length=parsers.length;while(++i<length){parser=parsers[i];result=parser(input);if(result!=null){return result}}}};newParser=function(options){var U;U={};U.wildcard=P.tag("wildcard",P.string(options.wildcardChar));U.optional=P.tag("optional",P.pick(1,P.string(options.optionalSegmentStartChar),P.lazy(function(){return U.pattern}),P.string(options.optionalSegmentEndChar)));U.name=P.regex(new RegExp("^["+options.segmentNameCharset+"]+"));U.named=P.tag("named",P.pick(1,P.string(options.segmentNameStartChar),P.lazy(function(){return U.name})));U.escapedChar=P.pick(1,P.string(options.escapeChar),P.regex(/^./));U["static"]=P.tag("static",P.concatMany1Till(P.firstChoice(P.lazy(function(){return U.escapedChar}),P.regex(/^./)),P.firstChoice(P.string(options.segmentNameStartChar),P.string(options.optionalSegmentStartChar),P.string(options.optionalSegmentEndChar),U.wildcard)));U.token=P.lazy(function(){return P.firstChoice(U.wildcard,U.optional,U.named,U["static"])});U.pattern=P.many1(P.lazy(function(){return U.token}));return U};defaultOptions={escapeChar:"\\",segmentNameStartChar:":",segmentValueCharset:"a-zA-Z0-9-_~ %",segmentNameCharset:"a-zA-Z0-9",optionalSegmentStartChar:"(",optionalSegmentEndChar:")",wildcardChar:"*"};baseAstNodeToRegexString=function(astNode,segmentValueCharset){if(Array.isArray(astNode)){return stringConcatMap(astNode,function(node){return baseAstNodeToRegexString(node,segmentValueCharset)})}switch(astNode.tag){case"wildcard":return"(.*?)";case"named":return"(["+segmentValueCharset+"]+)";case"static":return escapeForRegex(astNode.value);case"optional":return"(?:"+baseAstNodeToRegexString(astNode.value,segmentValueCharset)+")?"}};astNodeToRegexString=function(astNode,segmentValueCharset){if(segmentValueCharset==null){segmentValueCharset=defaultOptions.segmentValueCharset}return"^"+baseAstNodeToRegexString(astNode,segmentValueCharset)+"$"};astNodeToNames=function(astNode){if(Array.isArray(astNode)){return concatMap(astNode,astNodeToNames)}switch(astNode.tag){case"wildcard":return["_"];case"named":return[astNode.value];case"static":return[];case"optional":return astNodeToNames(astNode.value)}};getParam=function(params,key,nextIndexes,sideEffects){var index,maxIndex,result,value;if(sideEffects==null){sideEffects=false}value=params[key];if(value==null){if(sideEffects){throw new Error("no values provided for key `"+key+"`")}else{return}}index=nextIndexes[key]||0;maxIndex=Array.isArray(value)?value.length-1:0;if(index>maxIndex){if(sideEffects){throw new Error("too few values provided for key `"+key+"`")}else{return}}result=Array.isArray(value)?value[index]:value;if(sideEffects){nextIndexes[key]=index+1}return result};astNodeContainsSegmentsForProvidedParams=function(astNode,params,nextIndexes){var i,length;if(Array.isArray(astNode)){i=-1;length=astNode.length;while(++i<length){if(astNodeContainsSegmentsForProvidedParams(astNode[i],params,nextIndexes)){return true}}return false}switch(astNode.tag){case"wildcard":return getParam(params,"_",nextIndexes,false)!=null;case"named":return getParam(params,astNode.value,nextIndexes,false)!=null;case"static":return false;case"optional":return astNodeContainsSegmentsForProvidedParams(astNode.value,params,nextIndexes)}};stringify=function(astNode,params,nextIndexes){if(Array.isArray(astNode)){return stringConcatMap(astNode,function(node){return stringify(node,params,nextIndexes)})}switch(astNode.tag){case"wildcard":return getParam(params,"_",nextIndexes,true);case"named":return getParam(params,astNode.value,nextIndexes,true);case"static":return astNode.value;case"optional":if(astNodeContainsSegmentsForProvidedParams(astNode.value,params,nextIndexes)){return stringify(astNode.value,params,nextIndexes)}else{return""}}};UrlPattern=function(arg1,arg2){var groupCount,options,parsed,parser,withoutWhitespace;if(arg1 instanceof UrlPattern){this.isRegex=arg1.isRegex;this.regex=arg1.regex;this.ast=arg1.ast;this.names=arg1.names;return}this.isRegex=arg1 instanceof RegExp;if(!("string"===typeof arg1||this.isRegex)){throw new TypeError("argument must be a regex or a string")}if(this.isRegex){this.regex=arg1;if(arg2!=null){if(!Array.isArray(arg2)){throw new Error("if first argument is a regex the second argument may be an array of group names but you provided something else")}groupCount=regexGroupCount(this.regex);if(arg2.length!==groupCount){throw new Error("regex contains "+groupCount+" groups but array of group names contains "+arg2.length)}this.names=arg2}return}if(arg1===""){throw new Error("argument must not be the empty string")}withoutWhitespace=arg1.replace(/\s+/g,"");if(withoutWhitespace!==arg1){throw new Error("argument must not contain whitespace")}options={escapeChar:(arg2!=null?arg2.escapeChar:void 0)||defaultOptions.escapeChar,segmentNameStartChar:(arg2!=null?arg2.segmentNameStartChar:void 0)||defaultOptions.segmentNameStartChar,segmentNameCharset:(arg2!=null?arg2.segmentNameCharset:void 0)||defaultOptions.segmentNameCharset,segmentValueCharset:(arg2!=null?arg2.segmentValueCharset:void 0)||defaultOptions.segmentValueCharset,optionalSegmentStartChar:(arg2!=null?arg2.optionalSegmentStartChar:void 0)||defaultOptions.optionalSegmentStartChar,optionalSegmentEndChar:(arg2!=null?arg2.optionalSegmentEndChar:void 0)||defaultOptions.optionalSegmentEndChar,wildcardChar:(arg2!=null?arg2.wildcardChar:void 0)||defaultOptions.wildcardChar};parser=newParser(options);parsed=parser.pattern(arg1);if(parsed==null){throw new Error("couldn't parse pattern")}if(parsed.rest!==""){throw new Error("could only partially parse pattern")}this.ast=parsed.value;this.regex=new RegExp(astNodeToRegexString(this.ast,options.segmentValueCharset));this.names=astNodeToNames(this.ast)};UrlPattern.prototype.match=function(url){var groups,match;match=this.regex.exec(url);if(match==null){return null}groups=match.slice(1);if(this.names){return keysAndValuesToObject(this.names,groups)}else{return groups}};UrlPattern.prototype.stringify=function(params){if(params==null){params={}}if(this.isRegex){throw new Error("can't stringify patterns generated from a regex")}if(params!==Object(params)){throw new Error("argument must be an object or undefined")}return stringify(this.ast,params,{})};UrlPattern.escapeForRegex=escapeForRegex;UrlPattern.concatMap=concatMap;UrlPattern.stringConcatMap=stringConcatMap;UrlPattern.regexGroupCount=regexGroupCount;UrlPattern.keysAndValuesToObject=keysAndValuesToObject;UrlPattern.P=P;UrlPattern.newParser=newParser;UrlPattern.defaultOptions=defaultOptions;UrlPattern.astNodeToRegexString=astNodeToRegexString;UrlPattern.astNodeToNames=astNodeToNames;UrlPattern.getParam=getParam;UrlPattern.astNodeContainsSegmentsForProvidedParams=astNodeContainsSegmentsForProvidedParams;UrlPattern.stringify=stringify;return UrlPattern})},{}],5:[function(require,module,exports){if(typeof Object.create==="function"){module.exports=function inherits(ctor,superCtor){ctor.super_=superCtor;ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:false,writable:true,configurable:true}})}}else{module.exports=function inherits(ctor,superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype;ctor.prototype=new TempCtor;ctor.prototype.constructor=ctor}}},{}],6:[function(require,module,exports){module.exports=function isBuffer(arg){return arg&&typeof arg==="object"&&typeof arg.copy==="function"&&typeof arg.fill==="function"&&typeof arg.readUInt8==="function"}},{}],7:[function(require,module,exports){(function(process,global){var formatRegExp=/%[sdj%]/g;exports.format=function(f){if(!isString(f)){var objects=[];for(var i=0;i<arguments.length;i++){objects.push(inspect(arguments[i]))}return objects.join(" ")}var i=1;var args=arguments;var len=args.length;var str=String(f).replace(formatRegExp,function(x){if(x==="%%")return"%";if(i>=len)return x;switch(x){case"%s":return String(args[i++]);case"%d":return Number(args[i++]);case"%j":try{return JSON.stringify(args[i++])}catch(_){return"[Circular]"}default:return x}});for(var x=args[i];i<len;x=args[++i]){if(isNull(x)||!isObject(x)){str+=" "+x}else{str+=" "+inspect(x)}}return str};exports.deprecate=function(fn,msg){if(isUndefined(global.process)){return function(){return exports.deprecate(fn,msg).apply(this,arguments)}}if(process.noDeprecation===true){return fn}var warned=false;function deprecated(){if(!warned){if(process.throwDeprecation){throw new Error(msg)}else if(process.traceDeprecation){console.trace(msg)}else{console.error(msg)}warned=true}return fn.apply(this,arguments)}return deprecated};var debugs={};var debugEnviron;exports.debuglog=function(set){if(isUndefined(debugEnviron))debugEnviron=process.env.NODE_DEBUG||"";set=set.toUpperCase();if(!debugs[set]){if(new RegExp("\\b"+set+"\\b","i").test(debugEnviron)){var pid=process.pid;debugs[set]=function(){var msg=exports.format.apply(exports,arguments);console.error("%s %d: %s",set,pid,msg)}}else{debugs[set]=function(){}}}return debugs[set]};function inspect(obj,opts){var ctx={seen:[],stylize:stylizeNoColor};if(arguments.length>=3)ctx.depth=arguments[2];if(arguments.length>=4)ctx.colors=arguments[3];if(isBoolean(opts)){ctx.showHidden=opts}else if(opts){exports._extend(ctx,opts)}if(isUndefined(ctx.showHidden))ctx.showHidden=false;if(isUndefined(ctx.depth))ctx.depth=2;if(isUndefined(ctx.colors))ctx.colors=false;if(isUndefined(ctx.customInspect))ctx.customInspect=true;if(ctx.colors)ctx.stylize=stylizeWithColor;return formatValue(ctx,obj,ctx.depth)}exports.inspect=inspect;inspect.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};inspect.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function stylizeWithColor(str,styleType){var style=inspect.styles[styleType];if(style){return"["+inspect.colors[style][0]+"m"+str+"["+inspect.colors[style][1]+"m"}else{return str}}function stylizeNoColor(str,styleType){return str}function arrayToHash(array){var hash={};array.forEach(function(val,idx){hash[val]=true});return hash}function formatValue(ctx,value,recurseTimes){if(ctx.customInspect&&value&&isFunction(value.inspect)&&value.inspect!==exports.inspect&&!(value.constructor&&value.constructor.prototype===value)){var ret=value.inspect(recurseTimes,ctx);if(!isString(ret)){ret=formatValue(ctx,ret,recurseTimes)}return ret}var primitive=formatPrimitive(ctx,value);if(primitive){return primitive}var keys=Object.keys(value);var visibleKeys=arrayToHash(keys);if(ctx.showHidden){keys=Object.getOwnPropertyNames(value)}if(isError(value)&&(keys.indexOf("message")>=0||keys.indexOf("description")>=0)){return formatError(value)}if(keys.length===0){if(isFunction(value)){var name=value.name?": "+value.name:"";return ctx.stylize("[Function"+name+"]","special")}if(isRegExp(value)){return ctx.stylize(RegExp.prototype.toString.call(value),"regexp")}if(isDate(value)){return ctx.stylize(Date.prototype.toString.call(value),"date")}if(isError(value)){return formatError(value)}}var base="",array=false,braces=["{","}"];if(isArray(value)){array=true;braces=["[","]"]}if(isFunction(value)){var n=value.name?": "+value.name:"";base=" [Function"+n+"]"}if(isRegExp(value)){base=" "+RegExp.prototype.toString.call(value)}if(isDate(value)){base=" "+Date.prototype.toUTCString.call(value)}if(isError(value)){base=" "+formatError(value)}if(keys.length===0&&(!array||value.length==0)){return braces[0]+base+braces[1]}if(recurseTimes<0){if(isRegExp(value)){return ctx.stylize(RegExp.prototype.toString.call(value),"regexp")}else{return ctx.stylize("[Object]","special")}}ctx.seen.push(value);var output;if(array){output=formatArray(ctx,value,recurseTimes,visibleKeys,keys)}else{output=keys.map(function(key){return formatProperty(ctx,value,recurseTimes,visibleKeys,key,array)})}ctx.seen.pop();return reduceToSingleString(output,base,braces)}function formatPrimitive(ctx,value){if(isUndefined(value))return ctx.stylize("undefined","undefined");if(isString(value)){var simple="'"+JSON.stringify(value).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return ctx.stylize(simple,"string")}if(isNumber(value))return ctx.stylize(""+value,"number");if(isBoolean(value))return ctx.stylize(""+value,"boolean");if(isNull(value))return ctx.stylize("null","null")}function formatError(value){return"["+Error.prototype.toString.call(value)+"]"}function formatArray(ctx,value,recurseTimes,visibleKeys,keys){var output=[];for(var i=0,l=value.length;i<l;++i){if(hasOwnProperty(value,String(i))){output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,String(i),true))}else{output.push("")}}keys.forEach(function(key){if(!key.match(/^\d+$/)){output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,key,true))}});return output}function formatProperty(ctx,value,recurseTimes,visibleKeys,key,array){var name,str,desc;desc=Object.getOwnPropertyDescriptor(value,key)||{value:value[key]};if(desc.get){if(desc.set){str=ctx.stylize("[Getter/Setter]","special")}else{str=ctx.stylize("[Getter]","special")}}else{if(desc.set){str=ctx.stylize("[Setter]","special")}}if(!hasOwnProperty(visibleKeys,key)){name="["+key+"]"}if(!str){if(ctx.seen.indexOf(desc.value)<0){if(isNull(recurseTimes)){str=formatValue(ctx,desc.value,null)}else{str=formatValue(ctx,desc.value,recurseTimes-1)}if(str.indexOf("\n")>-1){if(array){str=str.split("\n").map(function(line){return"  "+line}).join("\n").substr(2)}else{str="\n"+str.split("\n").map(function(line){return"   "+line}).join("\n")}}}else{str=ctx.stylize("[Circular]","special")}}if(isUndefined(name)){if(array&&key.match(/^\d+$/)){return str}name=JSON.stringify(""+key);if(name.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)){name=name.substr(1,name.length-2);name=ctx.stylize(name,"name")}else{name=name.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'");name=ctx.stylize(name,"string")}}return name+": "+str}function reduceToSingleString(output,base,braces){var numLinesEst=0;var length=output.reduce(function(prev,cur){numLinesEst++;if(cur.indexOf("\n")>=0)numLinesEst++;return prev+cur.replace(/\u001b\[\d\d?m/g,"").length+1},0);if(length>60){return braces[0]+(base===""?"":base+"\n ")+" "+output.join(",\n  ")+" "+braces[1]}return braces[0]+base+" "+output.join(", ")+" "+braces[1]}function isArray(ar){return Array.isArray(ar)}exports.isArray=isArray;function isBoolean(arg){return typeof arg==="boolean"}exports.isBoolean=isBoolean;function isNull(arg){return arg===null}exports.isNull=isNull;function isNullOrUndefined(arg){return arg==null}exports.isNullOrUndefined=isNullOrUndefined;function isNumber(arg){return typeof arg==="number"}exports.isNumber=isNumber;function isString(arg){return typeof arg==="string"}exports.isString=isString;function isSymbol(arg){return typeof arg==="symbol"}exports.isSymbol=isSymbol;function isUndefined(arg){return arg===void 0}exports.isUndefined=isUndefined;function isRegExp(re){return isObject(re)&&objectToString(re)==="[object RegExp]"}exports.isRegExp=isRegExp;function isObject(arg){return typeof arg==="object"&&arg!==null}exports.isObject=isObject;function isDate(d){return isObject(d)&&objectToString(d)==="[object Date]"}exports.isDate=isDate;function isError(e){return isObject(e)&&(objectToString(e)==="[object Error]"||e instanceof Error)}exports.isError=isError;function isFunction(arg){return typeof arg==="function"}exports.isFunction=isFunction;function isPrimitive(arg){return arg===null||typeof arg==="boolean"||typeof arg==="number"||typeof arg==="string"||typeof arg==="symbol"||typeof arg==="undefined"}exports.isPrimitive=isPrimitive;exports.isBuffer=require("./support/isBuffer");function objectToString(o){return Object.prototype.toString.call(o)}function pad(n){return n<10?"0"+n.toString(10):n.toString(10)}var months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function timestamp(){var d=new Date;var time=[pad(d.getHours()),pad(d.getMinutes()),pad(d.getSeconds())].join(":");return[d.getDate(),months[d.getMonth()],time].join(" ")}exports.log=function(){console.log("%s - %s",timestamp(),exports.format.apply(exports,arguments))};exports.inherits=require("inherits");exports._extend=function(origin,add){if(!add||!isObject(add))return origin;var keys=Object.keys(add);var i=keys.length;while(i--){origin[keys[i]]=add[keys[i]]}return origin};function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}}).call(this,require("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./support/isBuffer":6,_process:3,inherits:5}]},{},[1])(1)});